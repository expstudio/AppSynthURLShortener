<div class="landingpage" ng-controller="parentController">
    <div class="container">
        <div class="row appHeader">
            <div ng-include="'../../common/views/appHeader.html'"></div>
        </div>

        <div class="content">
            <form name="updateProfileForm" ng-submit="handleFormSubmit(updateProfileForm.$valid, picFile, student)"
                  class="form-horizontal col-xs-10 col-xs-offset-1 profileForm">

                <div class="col-sm-2 col-xs-12 profilePicture">
                    <i class="fa fa-user"></i>

                    <div>{{student.name}}</div>
                </div>
                <div class="col-sm-10 col-xs-12 info">
                    <div class="form-group">
                        <label for="nickname" class="control-label col-sm-3 col-xs-12">{{'NICKNAME' |
                            translate}}</label>

                        <div class="col-sm-9 col-xs-12">
                            <input type="text" name="nickname" class="form-control"
                                   ng-model="student.personalInfo.nickname"/>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="allergies" class="control-label col-sm-3 col-xs-12">{{'ALLERGIES' |
                            translate}}</label>

                        <div class="col-sm-9 col-xs-12">
                            <input type="text" name="allergies" class="form-control"
                                   ng-model="student.personalInfo.allergies"/>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="primaryContact" class="control-label col-sm-3 col-xs-12">{{'CONTACT_PERSON1' |
                            translate}}</label>

                        <div class="col-sm-9 col-xs-12">
                            <div class="row form-group">
                                <div class="col-md-6 col-sm-12 item">
                                    <input type="text" name="primaryContact" placeholder="{{'NAME' | translate}}"
                                           class="form-control" ng-model="student.personalInfo.primaryContact.name"/>
                                </div>
                                <div class="col-md-6 col-sm-12 item">
                                    <input type="text" name="primaryContact" placeholder="{{'ADDRESS' | translate}}"
                                           class="form-control" ng-model="student.personalInfo.primaryContact.address"/>
                                </div>

                                <div class="col-md-6 col-sm-12 item">
                                    <input type="text" name="primaryContact" placeholder="{{'EMAIL' | translate}}"
                                           class="form-control" ng-model="student.personalInfo.primaryContact.email"/>
                                </div>

                                <div class="col-md-6 col-sm-12 item">
                                    <input type="text" name="primaryContact" placeholder="{{'PHONE' | translate}}"
                                           class="form-control" ng-model="student.personalInfo.primaryContact.phone"/>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="guardians" class="control-label col-sm-3 col-xs-12">{{'CONTACT_PERSON2' |
                            translate}}</label>

                        <div class="col-sm-9 col-xs-12">
                            <div class="row form-group block" ng-repeat="guardian in student.personalInfo.guardians">
                                <div class="col-md-6 col-sm-12 item">
                                    <input type="text" name="primaryContact" placeholder="{{'NAME' | translate}}"
                                           class="form-control" ng-model="guardian.name"/>
                                </div>
                                <div class="col-md-6 col-sm-12 item">
                                    <input type="text" name="primaryContact" placeholder="{{'ADDRESS' | translate}}"
                                           class="form-control" ng-model="guardian.address"/>
                                </div>

                                <div class="col-md-6 col-sm-12 item">
                                    <input type="text" name="primaryContact" placeholder="{{'EMAIL' | translate}}"
                                           class="form-control" ng-model="guardian.email"/>
                                </div>

                                <div class="col-md-6 col-sm-12 item">
                                    <input type="text" name="primaryContact" placeholder="{{'PHONE' | translate}}"
                                           class="form-control" ng-model="guardian.phone"/>
                                </div>
                                <span ng-if="$index > 0" class="delete"
                                      ng-click="remove(student.personalInfo.guardians, $index)">
                                    <i class="fa fa-times"></i>
                                </span>
                            </div>
                        </div>
                        <div class="col-xs-12">
                            <button class="btn btn-primary pull-right" type="button"
                                    ng-click="addMore(student.personalInfo.guardians)">{{'ADD_MORE' | translate}}
                            </button>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="pickupPeople" class="control-label col-sm-3 col-xs-12">{{'PICKUP_PEOPLE' |
                            translate}}</label>

                        <div class="col-sm-9 col-xs-12">
                            <div class="row form-group block"
                                 ng-repeat="pickupPeople in student.personalInfo.pickupPeople">
                                <div class="col-md-6 col-sm-12 item">
                                    <input type="text" name="primaryContact" placeholder="{{'NAME' | translate}}"
                                           class="form-control" ng-model="pickupPeople.name"/>
                                </div>
                                <div class="col-md-6 col-sm-12 item">
                                    <input type="text" name="primaryContact" placeholder="{{'ADDRESS' | translate}}"
                                           class="form-control" ng-model="pickupPeople.address"/>
                                </div>

                                <div class="col-md-6 col-sm-12 item">
                                    <input type="text" name="primaryContact" placeholder="{{'EMAIL' | translate}}"
                                           class="form-control" ng-model="pickupPeople.email"/>
                                </div>

                                <div class="col-md-6 col-sm-12 item">
                                    <input type="text" name="primaryContact" placeholder="{{'PHONE' | translate}}"
                                           class="form-control" ng-model="pickupPeople.phone"/>
                                </div>
                                <span ng-if="$index > 0" class="delete"
                                      ng-click="remove(student.personalInfo.pickupPeople, $index)">
                                    <i class="fa fa-times"></i>
                                </span>
                            </div>
                        </div>
                        <div class="col-xs-12">
                            <button class="btn btn-primary pull-right" type="button"
                                    ng-click="addMore(student.personalInfo.pickupPeople)">{{'ADD_MORE' | translate}}
                            </button>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="otherNotes" class="control-label col-sm-3 col-xs-12">{{'OTHER_NOTES' |
                            translate}}</label>

                        <div class="col-sm-9 col-xs-12">
                        <textarea name="otherNotes" class="form-control" cols="30" rows="10"
                                  ng-model="student.personalInfo.otherNotes"></textarea>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="guardianPartner" class="control-label col-sm-3 col-xs-12">{{'ADD_USER' |
                            translate}}</label>

                        <div class="col-sm-9 col-xs-12">
                            <div class="row form-group block">
                                <div class="col-sm-12 item"
                                     ng-repeat="representative in student.personalInfo.newRepresentatives">
                                    <input type="text" name="guardianPartner" class="form-control"
                                           ng-model="representative.email"
                                           placeholder="{{'USERS_EMAIL' | translate}}"/>
                                </div>

                                <span ng-if="$index > 0" class="delete"
                                      ng-click="remove(student.personalInfo.newRepresentatives, $index)">
                                    <i class="fa fa-times"></i>
                                </span>
                            </div>
                        </div>
                        <div class="col-xs-12">
                            <button class="btn btn-primary pull-right" type="button"
                                    ng-click="addMore(student.personalInfo.newRepresentatives)">{{'ADD_MORE' |
                                translate}}
                            </button>
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="col-sm-12">
                            {{'PROFILE_PIC' | translate}}: <input type="file" ng-file-select="" ng-model="picFile"
                                                                  name="file" accept="image/*"
                                                                  ng-file-change="generateThumb(picFile[0], $files)">
                            <br>
                            <!--doesn't work with camel case -> dataSource-->
                            <div class="img-container">
                                <!--if we use ng-if, datasource is not updated ???-->
                                <img ng-show="picFile[0].dataUrl != null" id="profilePic"
                                     ng-src="{{picFile[0].dataUrl}}"
                                     ng-jcrop="{aspectRatio: 1, onChange: updatePreview, boxWidth: 450, boxHeight: 400}"
                                     datasource="datasource"/>
                            </div>
                            <div id="preview-pane" ng-show="picFile[0].dataUrl != null">
                                <div class="preview-container">
                                    <img ng-src="{{picFile[0].dataUrl}}" class="jcrop-preview" alt="Preview"/>
                                </div>
                            </div>
                            <span class="progress" ng-show="picFile[0].progress >= 0">
                                <div style="width:{{picFile[0].progress}}%" ng-bind="picFile[0].progress + '%'"
                                     class="ng-binding"></div>
                            </span>
                            <span ng-show="picFile[0].result">Upload Successful</span>
                        </div>
                    </div>
                    <button type="submit" class="btn btn-info pull-right">{{'Save profile' | translate}}</button>
                </div>
            </form>
        </div>

        <div class="appFooter">
            <div ng-include="'../../common/views/appFooter.html'"></div>
        </div>
    </div>
</div>
